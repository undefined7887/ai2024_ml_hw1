# Прогнозирование цены автомобиля

Выполнил: Евстафьев Ярослав Михайлович

## Что сделано:

Предобработка данных:

- Удалены ненужные столбцы, такие как `selling_price`, `torque` и `name`.
- Обработаны пропущенные значения в числовых столбцах путем заполнения их медианным значением.
- Применен StandardScaler к числовым столбцам.
- Применен OneHotEncoder к категориальным столбцам.

Были опробованы различные модели:

- `LinearRegression`
- `LinearRegression` на скалированных данных
- `Lasso`
- `ElasticNet`
- `Ridge` с категориальными признаками

Для `Lasso`, `ElasticNet` и `Ridge` были подобраны лучшие параметры с помощью `GridSearchCV`.

Для каждой модели были посчитаны метрики `MSE` и `R2`.

## Сервис на FastAPI:

- В файлы `.pkl` была сохранена модель, а также объекты StandardScaler и OneHotEncoder.
- В файле `service.py` создан сервис на FastAPI, который имеет 2 метода:
    - `/predict_item`, который принимает POST запрос с json объектом и возвращает предсказание цены автомобиля
    - `/predict_items`, который принимает POST запрос с csv файлом и возвращает обновленный csv файл с колонкой
      `selling_price` с предсказанными ценами автомобилей
- Протестировано вручную с использованием Postman.

## Что дало наибольший буст в качестве:

Наибольший буст в качестве дало применение OneHotEncoder к категориальным признакам с использованием Ridge регрессии (не
понятно что конкретно дало буст).

## Что сделать не вышло и почему:

Не вышло понять, почему на бизнес метрике ElasticNet без категориальных признаков показывает наилучший результат.